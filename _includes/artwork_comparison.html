<div class="comparison-tool" id="comparison-tool" style="margin: 30px 0;">
  <h4 style="margin-bottom: 15px;">Compare Artworks</h4>
  
  <div class="comparison-controls" style="margin-bottom: 20px;">
    <select id="compare-artwork-1" class="compare-select" style="padding: 8px; margin-right: 10px; border-radius: 4px; border: 1px solid #ccc;">
      <option value="">Select first artwork...</option>
      {% for item in site.syrian_refugee_art %}
        <option value="{{ item.pid }}" {% if item.pid == page.pid %}selected{% endif %}>{{ item.title }} - {{ item.artist }}</option>
      {% endfor %}
    </select>
    
    <select id="compare-artwork-2" class="compare-select" style="padding: 8px; margin-right: 10px; border-radius: 4px; border: 1px solid #ccc;">
      <option value="">Select second artwork...</option>
      {% for item in site.syrian_refugee_art %}
        <option value="{{ item.pid }}">{{ item.title }} - {{ item.artist }}</option>
      {% endfor %}
    </select>
    
    <button onclick="compareArtworks()" class="btn-compare" style="padding: 8px 20px; background-color: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
      Compare
    </button>
    
    <button onclick="clearComparison()" class="btn-clear" style="padding: 8px 20px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; margin-left: 10px;">
      Clear
    </button>
  </div>
  
  <div id="comparison-results" style="display: none;">
    <div class="comparison-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
      <div id="artwork-1-details" class="comparison-item" style="padding: 15px; background-color: #f8f9fa; border-radius: 8px;"></div>
      <div id="artwork-2-details" class="comparison-item" style="padding: 15px; background-color: #f8f9fa; border-radius: 8px;"></div>
    </div>
  </div>
</div>

<script>
var artworks = {
  {% for item in site.syrian_refugee_art %}
  "{{ item.pid }}": {
    title: {{ item.title | jsonify }},
    artist: {{ item.artist | jsonify }},
    date: {{ item._date | jsonify }},
    description: {{ item.description | jsonify }},
    medium: {{ item.medium | jsonify }},
    location: {{ item.location | jsonify }},
    thumbnail: {{ item.thumbnail | jsonify }},
    url: {{ item.url | jsonify }}
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
};

function compareArtworks() {
  var pid1 = document.getElementById('compare-artwork-1').value;
  var pid2 = document.getElementById('compare-artwork-2').value;
  
  if (!pid1 || !pid2) {
    alert('Please select two artworks to compare.');
    return;
  }
  
  if (pid1 === pid2) {
    alert('Please select two different artworks.');
    return;
  }
  
  var artwork1 = artworks[pid1];
  var artwork2 = artworks[pid2];
  
  if (!artwork1 || !artwork2) {
    alert('Error loading artwork data.');
    return;
  }
  
  displayComparison(artwork1, artwork2);
  trackAction('compare', pid1 + '_vs_' + pid2, pid1);
}

function displayComparison(artwork1, artwork2) {
  var resultsDiv = document.getElementById('comparison-results');
  var item1Div = document.getElementById('artwork-1-details');
  var item2Div = document.getElementById('artwork-2-details');
  
  item1Div.innerHTML = `
    <h5><a href="${artwork1.url}">${artwork1.title}</a></h5>
    <img src="${artwork1.thumbnail}" alt="${artwork1.title}" style="width: 100%; max-width: 300px; margin: 10px 0; border-radius: 4px;">
    <p><strong>Artist:</strong> ${artwork1.artist}</p>
    <p><strong>Date:</strong> ${artwork1.date || 'N/A'}</p>
    <p><strong>Medium:</strong> ${artwork1.medium || 'N/A'}</p>
    <p><strong>Location:</strong> ${artwork1.location || 'N/A'}</p>
    <p><strong>Description:</strong> ${artwork1.description || 'N/A'}</p>
  `;
  
  item2Div.innerHTML = `
    <h5><a href="${artwork2.url}">${artwork2.title}</a></h5>
    <img src="${artwork2.thumbnail}" alt="${artwork2.title}" style="width: 100%; max-width: 300px; margin: 10px 0; border-radius: 4px;">
    <p><strong>Artist:</strong> ${artwork2.artist}</p>
    <p><strong>Date:</strong> ${artwork2.date || 'N/A'}</p>
    <p><strong>Medium:</strong> ${artwork2.medium || 'N/A'}</p>
    <p><strong>Location:</strong> ${artwork2.location || 'N/A'}</p>
    <p><strong>Description:</strong> ${artwork2.description || 'N/A'}</p>
  `;
  
  resultsDiv.style.display = 'block';
  resultsDiv.scrollIntoView({ behavior: 'smooth' });
}

function clearComparison() {
  document.getElementById('comparison-results').style.display = 'none';
  document.getElementById('compare-artwork-1').value = '';
  document.getElementById('compare-artwork-2').value = '';
}

// Track comparison actions
function trackAction(actionType, actionDetail, artworkId) {
  if (typeof localStorage !== 'undefined') {
    var actions = JSON.parse(localStorage.getItem('syrianRefugeeArtActions') || '{}');
    var key = actionType + '_' + actionDetail;
    actions[key] = (actions[key] || 0) + 1;
    actions['total_' + actionType] = (actions['total_' + actionType] || 0) + 1;
    localStorage.setItem('syrianRefugeeArtActions', JSON.stringify(actions));
    updateImpactCounter();
  }
}
</script>

<style>
@media (max-width: 768px) {
  .comparison-grid {
    grid-template-columns: 1fr !important;
  }
}
</style>

